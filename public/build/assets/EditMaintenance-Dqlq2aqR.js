import{r as n,j as s}from"./app-BhVfn1oG.js";import{d as h}from"./index-DQyQdIxH.js";import{L as E}from"./Layout-BLsYlLAs.js";import{B as p}from"./react-toastify.esm-CKf9o2XU.js";import"./NotificationList-D7J_jy85.js";import"./index-CHXlp1va.js";import"./index-CoD__97l.js";const M=({maintenance:r,equipments:o,errors:m,notifications:x,user:b})=>{const[t,d]=n.useState({title:r.title,description:r.description,equipment_id:r.equipment_id,procedures:null,frequency:r.frequency,parts:r.parts?r.parts.map(e=>e.id):[],tools:r.tools?r.tools.map(e=>e.id):[]}),[i,g]=n.useState(""),[f,y]=n.useState(o.filter(e=>e.category&&e.category.name.toUpperCase()==="PARTS")),[j,N]=n.useState(o.filter(e=>e.category&&e.category.name.toUpperCase()==="TOOLS"));n.useEffect(()=>{y(o.filter(e=>e.category&&e.category.name.toUpperCase()==="PARTS"&&e.name.toLowerCase().includes(i.toLowerCase()))),N(o.filter(e=>e.category&&e.category.name.toUpperCase()==="TOOLS"&&e.name.toLowerCase().includes(i.toLowerCase())))},[i,o]);const v=e=>{e.preventDefault();const l=new FormData;Object.keys(t).forEach(a=>{Array.isArray(t[a])?t[a].forEach((k,S)=>{l.append(`${a}[${S}]`,k)}):l.append(a,t[a])}),t.procedures&&l.append("procedures",t.procedures),h.Inertia.post(route("maintenance.update",r.id),l,{onSuccess:()=>p.success("Maintenance updated successfully!"),onError:()=>p.error("There was an error updating the maintenance."),headers:{"Content-Type":"multipart/form-data"}})},w=e=>{g(e.target.value)},u=(e,l)=>{const a=new Set(t[e]);a.has(l)?a.delete(l):a.add(l),d({...t,[e]:Array.from(a)})},C=o.filter(e=>e.category&&e.category.name.toUpperCase()==="EQUIPMENTS"),c=e=>m&&m[e]?s.jsx("span",{className:"text-red-600 text-sm",children:m[e]}):null;return s.jsx(E,{notifications:x,user:b,children:s.jsxs("div",{className:"max-w-3xl mx-auto p-4 sm:p-6 lg:p-8 bg-white shadow-md rounded-md",children:[s.jsx("h2",{className:"text-xl font-semibold mb-6",children:"Edit Maintenance"}),s.jsxs("form",{onSubmit:v,children:[s.jsxs("div",{className:"mb-4",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Title"}),s.jsx("input",{type:"text",value:t.title,onChange:e=>d({...t,title:e.target.value}),className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm"}),c("title")]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Description"}),s.jsx("textarea",{value:t.description,onChange:e=>d({...t,description:e.target.value}),className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm"}),c("description")]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Equipment"}),s.jsxs("select",{value:t.equipment_id,onChange:e=>d({...t,equipment_id:e.target.value}),className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm",children:[s.jsx("option",{value:"",children:"Select Equipment"}),C.map(e=>s.jsx("option",{value:e.id,children:e.name},e.id))]}),c("equipment_id")]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Procedures"}),s.jsx("input",{type:"file",onChange:e=>d({...t,procedures:e.target.files[0]}),className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm"}),c("procedures")]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Frequency"}),s.jsxs("select",{value:t.frequency,onChange:e=>d({...t,frequency:e.target.value}),className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm",children:[s.jsx("option",{value:"daily",children:"Daily"}),s.jsx("option",{value:"weekly",children:"Weekly"}),s.jsx("option",{value:"monthly",children:"Monthly"}),s.jsx("option",{value:"yearly",children:"Yearly"})]}),c("frequency")]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Search Parts/Tools"}),s.jsx("input",{type:"text",value:i,onChange:w,className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm",placeholder:"Search parts or tools"})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Parts"}),s.jsx("div",{className:"mt-1 grid grid-cols-2 gap-4",children:f.map(e=>s.jsxs("div",{className:"flex items-center",children:[s.jsx("input",{type:"checkbox",checked:t.parts.includes(e.id),onChange:()=>u("parts",e.id),className:"mr-2"}),s.jsx("span",{children:e.name})]},e.id))})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Tools"}),s.jsx("div",{className:"mt-1 grid grid-cols-2 gap-4",children:j.map(e=>s.jsxs("div",{className:"flex items-center",children:[s.jsx("input",{type:"checkbox",checked:t.tools.includes(e.id),onChange:()=>u("tools",e.id),className:"mr-2"}),s.jsx("span",{children:e.name})]},e.id))})]}),s.jsxs("div",{className:"mt-6 flex justify-between",children:[s.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-500 text-white font-semibold rounded-md shadow-sm hover:bg-blue-600",children:"Update"}),s.jsx("button",{type:"button",onClick:()=>h.Inertia.get(route("maintenance.index")),className:"px-4 py-2 bg-gray-500 text-white font-semibold rounded-md shadow-sm hover:bg-gray-600",children:"Back"})]})]})]})})};export{M as default};
